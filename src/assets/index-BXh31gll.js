import{x as _,a6 as y}from"./index-Ch2xGh_u.js";import{B as g,N as I,a as k,ar as v,w as L,I as p,Z as w,C as E,D as u,O as d,U as b,H as m,u as o,P as f,_ as N,p as C,G as T,V as D,aK as x,au as A}from"./vue-opd7UYcs.js";import{u as S,P as U,a as q}from"./popupForm-BrEraj9a.js";import{b as P,T as z,a as B}from"./index-CVqxjh9c.js";import"./index-qsNMGeAX.js";import"./validate-Bdk_hEWy.js";import"./index-CtStWFRv.js";const F={class:"default-main ba-table-box"},G={class:"table-header-operate-text"},J=g({name:"user/moneyLog",__name:"index",setup(R){const{t:a}=_.useI18n(),h=I().query.user_id??"",t=k({userInfo:{}}),e=new P(new y(S),{column:[{type:"selection",align:"center",operator:!1},{label:a("Id"),prop:"id",align:"center",operator:"=",operatorPlaceholder:a("Id"),width:70},{label:a("user.moneyLog.User ID"),prop:"user_id",align:"center",width:70},{label:a("user.moneyLog.User name"),prop:"user.username",align:"center",operator:"LIKE",operatorPlaceholder:a("Fuzzy query")},{label:a("user.moneyLog.User nickname"),prop:"user.nickname",align:"center",operator:"LIKE",operatorPlaceholder:a("Fuzzy query")},{label:a("user.moneyLog.Change balance"),prop:"money",align:"center",operator:"RANGE",sortable:"custom"},{label:a("user.moneyLog.Before change"),prop:"before",align:"center",operator:"RANGE",sortable:"custom"},{label:a("user.moneyLog.After change"),prop:"after",align:"center",operator:"RANGE",sortable:"custom"},{label:a("user.moneyLog.remarks"),prop:"memo",align:"center",operator:"LIKE",operatorPlaceholder:a("Fuzzy query"),showOverflowTooltip:!0},{label:a("Create time"),prop:"create_time",align:"center",render:"datetime",sortable:"custom",operator:"RANGE",width:160}],dblClickNotEditColumn:["all"]},{defaultItems:{user_id:h,memo:""}});e.after.onSubmit=()=>{i(e.comSearch.form.user_id)},e.before.onTableAction=({event:r})=>{if(r==="com-search"){e.table.filter.search=e.getComSearchData();for(const s in e.table.filter.search)if(["money","before","after"].includes(e.table.filter.search[s].field)){const l=e.table.filter.search[s].val.split(","),n=[];for(const c in l)n.push(isNaN(parseFloat(l[c]))?"":parseFloat(l[c])*100);e.table.filter.search[s].val=n.join(",")}return e.onTableHeaderAction("refresh",{event:"com-search",data:e.table.filter.search}),!1}},e.mount(),e.getData(),A("baTable",e);const i=v(r=>{r&&x(r)>0?q(r).then(s=>{t.userInfo=s.data.user}):t.userInfo={}},300);return i(e.comSearch.form.user_id),L(()=>e.comSearch.form.user_id,r=>{e.form.defaultItems.user_id=r,i(r)}),(r,s)=>{const l=p("el-alert"),n=p("el-button"),c=w("blur");return u(),E("div",F,[o(e).table.remark?(u(),d(l,{key:0,class:"ba-table-alert",title:o(e).table.remark,type:"info","show-icon":""},null,8,["title"])):b("",!0),m(z,{buttons:["refresh","add","comSearch","quickSearch","columnDisplay"],"quick-search-placeholder":o(a)("Quick search placeholder",{fields:o(a)("user.moneyLog.User name")+"/"+o(a)("user.moneyLog.User nickname")})},{default:f(()=>[o(C)(t.userInfo)?b("",!0):N((u(),d(n,{key:0,class:"table-header-operate"},{default:f(()=>[T("span",G,D(t.userInfo.username+"(ID:"+t.userInfo.id+") "+o(a)("user.moneyLog.balance")+":"+t.userInfo.money),1)]),_:1})),[[c]])]),_:1},8,["quick-search-placeholder"]),m(B),m(U)])}}});export{J as default};
